<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Category Batch Manager - Preview</title>
    <link rel="stylesheet" href="../dist/css.css">
    <!-- load jquery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- load codex style -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codex/2.3.2/codex.style.min.css" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/codex-design-tokens/2.3.2/theme-wikimedia-ui.css" />

    <!-- <script type="module" src="https://cdnjs.cloudflare.com/ajax/libs/codex/2.3.2/codex.min.js"></script> -->
    <style>
        /* زر إعادة الفتح */
        #cbm-reopen-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            display: none;
        }

        /* توسيع النافذة */
        .cbm-container {
            width: 80vw !important;
            max-width: 1400px !important;
            max-height: 95vh !important;
        }

        .cbm-body {
            height: 700px;
        }

        .cbm-main-layout {
            display: flex;
            gap: 20px;
            height: 100%;
        }

        .cbm-left-panel {
            flex: 2;
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
            min-width: 0;
        }

        .cbm-right-panel {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            border: 1px solid #eaecf0;
            border-radius: 2px;
            background: #f8f9fa;
        }

        .cbm-right-panel .cbm-results {
            height: 100%;
            max-height: none !important;
            display: flex;
            flex-direction: column;
            padding: 0 !important;
            border: none !important;
        }

        .cbm-right-panel .cbm-results-header {
            flex-shrink: 0;
            margin: 0 !important;
            padding: 12px 16px !important;
            border-radius: 0 !important;
            border-bottom: 1px solid #a2a9b1;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .cbm-right-panel #cbm-file-list {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
            background: #fff;
        }

        /* تحسين عرض صفوف الملفات */
        .cbm-file-row {
            padding: 10px 12px;
            font-size: 14px;
        }
    </style>
</head>

<body>

    <!-- زر إعادة فتح القائمة -->
    <button id="cbm-reopen-btn"
        class="cdx-button cdx-button--action-progressive cdx-button--weight-primary cdx-button--size-large cdx-button--icon-only"
        aria-label="Open Category Batch Manager" title="Open Category Batch Manager">
        ☰
    </button>

    <div id="category-batch-manager" class="cbm-container">        <div class="cbm-header">
            <h2>Category Batch Manager</h2>
            <div>
                <button
                    class="cdx-button cdx-button--action-default cdx-button--weight-quiet cdx-button--size-medium cdx-button--icon-only"
                    id="cbm-minimize" aria-label="Minimize" title="Minimize">−</button>
                <button
                    class="cdx-button cdx-button--action-default cdx-button--weight-quiet cdx-button--size-medium cdx-button--icon-only cbm-close"
                    id="cbm-close" aria-label="Close" title="Close">&#215;</button>
            </div>
        </div>
        <div class="cbm-body">
            <div class="cbm-main-layout">
                <!-- Left Panel: Search and Actions -->
                <div class="cbm-left-panel">
                    <div class="cbm-search">
                        <div class="cdx-field">
                            <div class="cdx-label">
                                <label class="cdx-label__label" for="cbm-source-category">
                                    <span class="cdx-label__label__text">Source Category</span>
                                </label>
                            </div>
                            <div class="cdx-field__control">
                                <div class="cdx-text-input">
                                    <input id="cbm-source-category" class="cdx-text-input__input" type="text"
                                        value="Category:Sample_Files" value="Category:Example">
                                </div>
                            </div>
                        </div>

                        <div class="cdx-field">
                            <div class="cdx-label">
                                <label class="cdx-label__label" for="cbm-pattern">
                                    <span class="cdx-label__label__text">Search Pattern</span>
                                </label>
                                <span class="cdx-label__description">
                                    Enter a pattern to filter files (e.g., ,BLR.svg)
                                </span>
                            </div>
                            <div class="cdx-field__control cbm-search-row">
                                <div class="cdx-text-input" style="flex: 1;">
                                    <input id="cbm-pattern" class="cdx-text-input__input" type="text"
                                        placeholder="e.g., ,BLR.svg">
                                </div>
                                <button id="cbm-search-btn"
                                    class="cdx-button cdx-button--action-progressive cdx-button--weight-primary cdx-button--size-medium">
                                    Search
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="cbm-results-message" class="hidden">
                    </div>

                    <div class="cbm-actions">
                        <div class="cdx-field">
                            <div class="cdx-label">
                                <label class="cdx-label__label" for="cbm-add-cats">
                                    <span class="cdx-label__label__text">Add Categories (comma-separated)</span>
                                </label>
                                <span class="cdx-label__description">
                                    e.g., Category:Belarus, Category:Europe
                                </span>
                            </div>
                            <div class="cdx-field__control">
                                <div class="cdx-text-input">
                                    <input id="cbm-add-cats" class="cdx-text-input__input" type="text"
                                        value="Category:Example">
                                </div>
                            </div>
                        </div>

                        <div class="cdx-field">
                            <div class="cdx-label">
                                <label class="cdx-label__label" for="cbm-remove-cats">
                                    <span class="cdx-label__label__text">Remove Categories (comma-separated)</span>
                                </label>
                            </div>
                            <div class="cdx-field__control">
                                <div class="cdx-text-input">
                                    <input id="cbm-remove-cats" class="cdx-text-input__input" type="text"
                                        value="Category:Old">
                                </div>
                            </div>
                        </div>

                        <div class="cdx-field">
                            <div class="cdx-label">
                                <label class="cdx-label__label" for="cbm-summary">
                                    <span class="cdx-label__label__text">Edit Summary</span>
                                </label>
                            </div>
                            <div class="cdx-field__control">
                                <div class="cdx-text-input">
                                    <input id="cbm-summary" class="cdx-text-input__input" type="text"
                                        value="Batch category update via Category Batch Manager">
                                </div>
                            </div>
                        </div>

                        <div class="cbm-selected-count">
                            Selected: <strong id="cbm-selected">0</strong> files
                        </div>                        <div class="cbm-buttons">
                            <button id="cbm-preview"
                                class="cdx-button cdx-button--action-default cdx-button--weight-normal cdx-button--size-medium">
                                Preview Changes
                            </button>
                            <button id="cbm-execute"
                                class="cdx-button cdx-button--action-progressive cdx-button--weight-primary cdx-button--size-medium">
                                GO
                            </button>
                            <button id="cbm-stop" style="display: none;"
                                class="cdx-button cdx-button--action-destructive cdx-button--weight-primary cdx-button--size-medium">
                                Stop Process
                            </button>
                        </div>
                    </div>

                    <div id="cbm-progress" class="cbm-progress hidden">
                        <div class="cdx-progress-bar cdx-progress-bar--block" role="progressbar"
                            aria-label="Batch processing progress">
                            <div id="cbm-progress-fill" class="cdx-progress-bar__bar cbm-progress-fill"></div>
                        </div>
                        <div id="cbm-progress-text" class="cbm-progress-text">Processing...</div>
                    </div>
                </div>

                <!-- Right Panel: File List -->
                <div class="cbm-right-panel">
                    <div class="cbm-results">
                        <div id="cbm-results-header" class="cbm-results-header hidden">
                            <div class="cdx-info-chip cdx-info-chip--notice">
                                <span class="cdx-info-chip__text">
                                    Found <strong id="cbm-count">0</strong> files
                                </span>
                            </div>
                            <button id="cbm-select-all"
                                class="cdx-button cdx-button--action-default cdx-button--weight-quiet cdx-button--size-medium">
                                Select All
                            </button>
                            <button id="cbm-deselect-all"
                                class="cdx-button cdx-button--action-default cdx-button--weight-quiet cdx-button--size-medium">
                                Deselect All
                            </button>
                        </div>
                        <div id="cbm-file-list"></div>
                    </div>
                </div>
            </div>            <div id="cbm-preview-modal" class="cbm-modal hidden">
                <div class="cbm-modal-content">
                    <h3>Preview Changes</h3>
                    <div id="cbm-preview-content"></div>
                    <button id="cbm-preview-close"
                        class="cdx-button cdx-button--action-default cdx-button--weight-normal cdx-button--size-medium">
                        Close
                    </button>
                </div>
            </div>

            <!-- Confirmation Dialog -->
            <div id="cbm-confirm-dialog" class="cbm-dialog-backdrop hidden">
                <div class="cbm-dialog">
                    <div class="cbm-dialog-header">
                        <h3 id="cbm-dialog-title">Confirm Action</h3>
                    </div>
                    <div class="cbm-dialog-body">
                        <p id="cbm-dialog-message"></p>
                    </div>
                    <div class="cbm-dialog-footer">
                        <button id="cbm-dialog-cancel"
                            class="cdx-button cdx-button--action-default cdx-button--weight-normal cdx-button--size-medium">
                            Cancel
                        </button>
                        <button id="cbm-dialog-confirm"
                            class="cdx-button cdx-button--action-progressive cdx-button--weight-primary cdx-button--size-medium">
                            Confirm
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Load the main application script from modal.html -->
        <!-- <script defer src="js.js"></script> -->

        <!-- Demo-specific functions -->
        <script src="demo.js"></script>
</body>

</html>
